핵심 용어: Virtual DOM, 렌더링, DOM

# React에서 렌더링

## DOM

HTML 문서를 파싱하여 문서의 구성요소들을 객체로 구조화하여 나타낸 것

## 렌더링이란?

궁극적으로 이미지를 생성하는 과정. 즉, 브라우저가 화면에 생성된 DOM 요소들을 그리는 것을 말한다.

## Virtual DOM

DOM을 추상화한 계층,
애플리케이션의 상태 변경시 Virtual DOM에 업데이트된다. React는 이전의 Virtual DOM 스냅샷과 비교한 뒤 변경된 내용만 업데이트합니다.
[재조정 과정](https://ko.reactjs.org/docs/reconciliation.html#gatsby-focus-wrapper)

## React는 언제 리렌더링 될까?

React의 컴포넌트 상태가 변경될 때 렌더링을 "예약"합니다.

렌더링 예약은 즉시 수행되는 것이 아닌 걸 의미합니다. React는 렌더링 하기에 적합한 순간을 찾기 시작합니다.

상태를 변경한다는 것은 컴포넌트의 render 함수가 호출되고 props의 변경 여부와 관계없이 모든 하위 컴포넌트들이 리렌더링 됩니다.

만약 애플리케이션이 제대로 구조화되어 있지 않은 경우, 상위 노드를 업데이트하면 모든 자식들의 render 함수를 실행해야하기 때문에 오버헤드가 생깁니다.

## props가 변경될 때, React 컴포넌트가 업데이트 되지 않는 이유?

props가 변경되었음에도 React가 구성 요소를 업데이트 하지 않는 2가지 일반적인 이유

1. props가 setState를 통해 올바르게 업데이트되지 않음
2. props에 대한 참조가 동일하게 유지됨

## 리렌더링을 최적화하는 방법

상위 컴포넌트가 하위 컴포넌트의 상태를 제어하는 경우 컴포넌트의 상태가 변경되면 모든 자식들이 리렌더링됨을 기억하자!

### 컴포넌트의 업데이트 시점 제어하기

React는 이러한 불필요한 업데이트를 방지하기 위해 몇가지 함수를 제공합니다.

#### React.memo

React Hook 컴포넌트에서 props가 변경되지 않았을 때 렌더링 되는 것을 방지하는 함수입니다.

#### shouldComponentUpdate

React의 라이프 사이클 함수 중 하나이며 업데이트 시점을 React에게 알려줌으로써 렌더링 성능을 향상시킬 수 있습니다.

#### key 속성을 설정하기

경우에 따라, React에서는 컴포넌트를 식별하고 성능을 최적화하기 위해 key 속성에 의존합니다.

예를 들어 배열로 그려진 컴포넌트가 있을 때 이벤트가 발생하면 React는 모든 원소들이 변경되었다 생각하고 해당 요소를 리렌더링합니다. 하지만 요소에 key를 추가함으로써 이를 방지할 수 있습니다.

key는 형제간에만 고유해야 합니다.

#### 컴포넌트의 구조

React.memo함수를 남발하지말고 데이터가 사용되는 곳을 가깝게 배치한다면 필요하지 않을 수도 있습니다.

## 결론
